<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SpaceMining RL Environment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      background: #ffffff;
      color: #000000;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      background: #5492C7;
      color: #ffffff;
      padding: 1.5rem 2rem;
      text-align: center;
      font-size: 2.2rem;
      font-weight: bold;
      letter-spacing: 2px;
    }
    nav {
      background: #ffffff;
      padding: 0.5rem 2rem;
      text-align: right;
      border-bottom: 1px solid #e0e0e0;
    }
    .research-purpose {
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 4px;
    }
    nav a {
      color: #5492C7;
      margin-left: 2rem;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.1rem;
    }
    nav a:hover {
      color: #2a6496;
    }
    .container {
      max-width: 1000px;
      margin: 2rem auto;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.1);
      padding: 2rem;
      border: 1px solid #e0e0e0;
    }
    h2 {
      color: #5492C7;
      margin-top: 2rem;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 0.5rem;
    }
    .features, .quickstart, .config, .task, .demo {
      margin-bottom: 2rem;
    }
    code, pre {
      background: #f5f5f5;
      color: #333333;
      border-radius: 6px;
      padding: 0.2em 0.5em;
      font-size: 1em;
      border: 1px solid #e0e0e0;
    }
    .gif-gallery {
      display: flex;
      flex-direction: column;
      gap: 30px;
      margin-top: 1rem;
    }
    
    .gif-row {
      display: flex;
      justify-content: space-between;
      gap: 20px;
    }
    
    .gif-card {
      flex: 1;
      min-width: 0;
      background: #ffffff;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      text-align: center;
      border: 1px solid #e0e0e0;
    }
    .gif-card img {
      width: 220px;
      border-radius: 6px;
      margin-bottom: 0.5rem;
      background: #f5f5f5;
      border: 1px solid #e0e0e0;
    }
    .success { color: #4CAF50; }
    .failure { color: #F44336; }
    .learning { color: #FF9800; }
    a {
      color: #5492C7;
      text-decoration: none;
    }
    
    /* Demo section specific styles */
    .demo {
      width: 100%;
      margin: 0 auto;
      font-family: Arial, sans-serif;
    }
    
    .gif-gallery {
      display: flex;
      flex-direction: column;
      gap: 30px;
    }
    
    .gif-row {
      display: flex;
      justify-content: space-between;
      gap: 20px;
    }
    
    .gif-card {
      flex: 1;
      min-width: 0;
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 6px 12px rgba(0,0,0,0.1);
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      background: white;
      position: relative;
      cursor: pointer;
    }
    
    .gif-container {
      width: 100%;
      height: 180px; /* 稍微减小高度 */
      position: relative;
      overflow: hidden;
      background: #f5f5f5;
    }
    
    .gif-container img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* 改为cover以填充整个容器 */
      transition: transform 0.3s ease;
      cursor: pointer;
      animation: gifLoop 0.1s infinite;
    }
    
    @keyframes gifLoop {
      0% { opacity: 1; }
      50% { opacity: 1; }
      100% { opacity: 1; }
    }
    
    .gif-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.15);
    }
    
    .gif-card:hover img {
      transform: scale(1.1);
    }
    
    .gif-card div {
      padding: 12px 15px;
      text-align: center;
      font-weight: bold;
    }
    
    .gif-card small {
      display: block;
      padding: 8px 15px 15px;
      color: #666;
      font-size: 0.85em;
      line-height: 1.4;
    }
    
    /* 模态框样式 */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      backdrop-filter: blur(5px);
    }
    
    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 90%;
      max-height: 90%;
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      overflow: hidden;
    }
    
    .modal-img {
      width: 100%;
      height: auto;
      display: block;
      object-fit: contain;
      max-height: 80vh;
    }
    
    .modal-close {
      position: absolute;
      top: 10px;
      right: 15px;
      color: white;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      background: rgba(0,0,0,0.5);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.3s;
    }
    
    .modal-close:hover {
      background: rgba(0,0,0,0.8);
    }
    
    .modal-title {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 15px;
      font-size: 16px;
      font-weight: bold;
    }
    a:hover {
      text-decoration: underline;
    }
    ul {
      padding-left: 1.5rem;
    }
    li {
      margin-bottom: 0.5rem;
    }
    .legend {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
    }
    .legend h4 {
      margin-top: 0;
      color: #495057;
    }
    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      margin-right: 10px;
      border: 1px solid #ccc;
    }
    .research-purpose {
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 4px;
    }
    @media (max-width: 768px) {
      .container { 
        padding: 1rem; 
        max-width: 95%;
      }
      .gif-row { 
        flex-direction: column; 
        gap: 15px;
      }
      .gif-card { 
        width: 100%; 
      }
      nav { 
        text-align: center; 
      }
      nav a { 
        margin: 0 0.5rem; 
        font-size: 1rem;
      }
    }
    
    @media (max-width: 600px) {
      .container { 
        padding: 0.5rem; 
        margin: 1rem auto;
      }
      .gif-gallery { 
        gap: 20px; 
      }
      .gif-container {
        height: 150px;
      }
    }
  </style>
</head>
<body>
  <header>SpaceMining RL Environment</header>
  <nav>
    <a href="#purpose">Purpose</a>
    <a href="#demo">Demo</a>
    <a href="#features">Features</a>
    <a href="#task">Task</a>
    <a href="https://github.com/Lola-jo/space_mining" target="_blank">GitHub</a>
  </nav>
  <div class="container">
    <section>
      <h2>What is SpaceMining?</h2>
      <p>
        <b>SpaceMining</b> is a single-agent reinforcement learning environment simulating asteroid mining in a 2D space environment. The agent (mining robot) must collect resources from asteroids, deliver them to the mothership, manage energy consumption, and avoid moving obstacles while maximizing efficiency.
      </p>
    </section>
    
    <section id="purpose" class="research-purpose">
      <h2>Research Purpose</h2>
      <p>
        This environment was specifically designed to evaluate large language models' ability to design reward functions for unfamiliar environments without prior knowledge. Recent studies have raised concerns that large language models may carry prior knowledge from pretraining data about standard RL environments (like CartPole, BipedalWalker, Ant), leading to potential prompt leakage and evaluation biases.
      </p>
      <p>
        To address this issue, SpaceMining serves as a custom environment to assess true generalization capabilities on tasks free from such pretrained knowledge. This allows researchers to evaluate whether LLMs can effectively design reward functions for completely novel environments.
      </p>
    </section>
    
    <section id="demo" class="demo">
      <h2>Demo: Agent Behaviors</h2>
      <p>
        The GIF demonstrations showcase different agent behaviors and training outcomes, from successful resource collection to various failure modes and learning phases.
      </p>
      <div class="gif-gallery">
        <!-- 第一行 -->
        <div class="gif-row">
          <div class="gif-card">
            <div class="gif-container">
              <img src="assets/gif/space_mining_demo_episode_1_20250730_230841.gif" alt="Early Exploration">
            </div>
            <div class="learning">Early Exploration Eval num_timesteps=25000</div>
            <small>Initial learning phase</small>
          </div>
          <div class="gif-card">
            <div class="gif-container">
              <img src="assets/gif/space_mining_demo_episode_1_20250731_001359.gif" alt="Early Exploration">
            </div>
            <div class="learning">Early Exploration Eval num_timesteps=500000</div>
            <small>Initial learning phase</small>
          </div>
          <div class="gif-card">
            <div class="gif-container">
              <img src="assets/gif/space_mining_demo_episode_4_20250730_225245.gif" alt="Successful Mining">
            </div>
            <div class="success">Successful Mining</div>
            <small>Strategic resource collection</small>
          </div>
        </div>
        
        <!-- 第二行 -->
        <div class="gif-row">
          <div class="gif-card">
            <div class="gif-container">
              <img src="assets/gif/space_mining_demo_episode_5_20250730_224355.gif" alt="Complete Episode">
            </div>
            <div class="failure">Complete Episode (1200 steps)</div>
            <small>Optimal resource collection</small>
          </div>
          <div class="gif-card">
            <div class="gif-container">
              <img src="assets/gif/space_mining_demo_episode_3_20250730_224120.gif" alt="Energy Depletion">
            </div>
            <div class="failure">Energy Depletion</div>
            <small>Failed to recharge at mothership</small>
          </div>
          <div class="gif-card">
            <div class="gif-container">
              <img src="assets/gif/space_mining_demo_episode_4_20250730_222922.gif" alt="Poor Obstacle Avoidance">
            </div>
            <div class="failure">Poor Obstacle Avoidance</div>
            <small>Multiple collisions</small>
          </div>
        </div>
      </div>
    </section>
    
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const gifs = document.querySelectorAll('.gif-container img');
        
        // 创建模态框
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.innerHTML = '<div class="modal-content"><span class="modal-close">&times;</span><img class="modal-img" src="" alt=""><div class="modal-title"></div></div>';
        document.body.appendChild(modal);
        
        const modalImg = modal.querySelector('.modal-img');
        const modalTitle = modal.querySelector('.modal-title');
        const modalClose = modal.querySelector('.modal-close');
        
        // 强制GIF循环播放的函数
        function forceGifLoop(img) {
          img.setAttribute('loop', '');
          img.setAttribute('autoplay', '');
          img.setAttribute('playsinline', '');
          
          // 使用更可靠的方法重新加载GIF
          const src = img.src;
          const timestamp = new Date().getTime();
          const separator = src.includes('?') ? '&' : '?';
          img.src = src + separator + 't=' + timestamp;
        }
        
        gifs.forEach(gif => {
          // 初始设置GIF属性并强制循环
          forceGifLoop(gif);
          
          // 添加点击事件
          gif.addEventListener('click', function() {
            modalImg.src = this.src;
            modalTitle.textContent = this.alt;
            modal.style.display = 'block';
            
            // 强制模态框中的GIF循环播放
            setTimeout(() => {
              forceGifLoop(modalImg);
            }, 50);
          });
        });
        
        // 关闭模态框
        modalClose.addEventListener('click', function() {
          modal.style.display = 'none';
        });
        
        // 点击模态框背景关闭
        modal.addEventListener('click', function(e) {
          if (e.target === modal) {
            modal.style.display = 'none';
          }
        });
        
        // ESC键关闭模态框
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && modal.style.display === 'block') {
            modal.style.display = 'none';
          }
        });
        
        // 定期检查并强制GIF循环播放
        setInterval(() => {
          gifs.forEach(gif => {
            if (!gif.hasAttribute('loop')) {
              forceGifLoop(gif);
            }
          });
        }, 2000);
      });
    </script>
    
    <div class="legend">
      <h4>Visual Elements Legend</h4>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #32CD32;"></div>
        <span><strong>Green Circle:</strong> Agent (mining robot)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #32A1C8;"></div>
        <span><strong>Blue Circle:</strong> Mothership (delivery point)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #FFD700;"></div>
        <span><strong>Yellow Circles:</strong> Asteroids (mining targets)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #FF4500;"></div>
        <span><strong>Red Circles:</strong> Moving obstacles (avoid)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #FF0000;"></div>
        <span><strong>Red Ring:</strong> Mining range indicator</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background-color: #87CEEB;"></div>
        <span><strong>Light Blue Ring:</strong> Observation range</span>
      </div>
      <p><strong>Health Bars:</strong> Green to red bars above asteroids show remaining resources</p>
      <p><strong>Status Display:</strong> Top-left shows inventory, energy, and step count</p>
    </div>
  </section>
    
    <section id="features" class="features">
      <h2>Features</h2>
      <ul>
        <li>2D physics-based space mining simulation with realistic movement</li>
        <li>Dynamic resource management and energy consumption</li>
        <li>Partial observability with limited observation radius</li>
        <li>Moving obstacles and collision detection</li>
        <li>Customizable reward structure and environment parameters</li>
        <li>Real-time visualization with health bars and status indicators</li>
      </ul>
    </section>
    <section id="task" class="task">
      <h2>Task Description</h2>
      <p>
        The agent is deployed in a 2D space environment (80x80 grid) with randomly distributed asteroids and a central mothership. The agent must:
      </p>
      <ul>
        <li>Navigate efficiently to discover and mine resource-rich asteroids</li>
        <li>Manage energy consumption and return to the mothership for recharging</li>
        <li>Avoid collisions with moving obstacles</li>
        <li>Deliver resources to maximize collection efficiency</li>
        <li>Balance exploration and exploitation for optimal performance</li>
      </ul>
      <p>
        The environment uses a comprehensive fitness scoring system with a target range of approximately 3000 points, evaluating resource collection, energy management, efficiency, and survival time.
      </p>
    </section>
    <section>
      <h2>Environment Specifications</h2>
      <h3>State Space</h3>
      <p>The observation space includes:</p>
      <ul>
        <li><strong>Agent State (6 dimensions):</strong> Position (x, y), velocity (vx, vy), energy level, inventory</li>
        <li><strong>Asteroid Information (up to 45 dimensions):</strong> Relative positions and resource amounts for visible asteroids</li>
        <li><strong>Mothership Position (2 dimensions):</strong> Relative position to mothership</li>
      </ul>
      
      <h3>Action Space</h3>
      <p>The action space is continuous with 3 dimensions:</p>
      <ul>
        <li><strong>Thrust Control (2 dimensions):</strong> Force applied in x and y directions [-1.0, 1.0]</li>
        <li><strong>Mining Action (1 dimension):</strong> Binary mining activation [0.0, 1.0]</li>
      </ul>
      
      <h3>Difficulty Level</h3>
      <p>
        <strong>Medium Difficulty:</strong> The environment presents a balanced challenge with:
      </p>
      <ul>
        <li>Limited observation radius (15 units) requiring strategic exploration</li>
        <li>Energy management constraints requiring periodic returns to mothership</li>
        <li>Moving obstacles requiring collision avoidance</li>
        <li>Resource depletion mechanics requiring efficient mining strategies</li>
      </ul>
    </section>
    <section class="config">
      <h2>Recommended Training Configuration</h2>
      <p>
        The environment is optimized for <b>PPO</b> and other modern RL algorithms. Here are the recommended parameters:
      </p>
      <pre>
# Environment Parameters
max_episode_steps: 1200
grid_size: 80
max_asteroids: 12
max_resource_per_asteroid: 40
observation_radius: 15
mining_range: 8.0
max_inventory: 100

# Training Parameters
policy: MlpPolicy
learning_rate: 0.0003
total_timesteps: 3,000,000
batch_size: 64
n_steps: 2048
gamma: 0.99
gae_lambda: 0.95
clip_range: 0.2
      </pre>
    </section>
    <section class="quickstart">
      <h2>Quick Start</h2>
      <h3>Installation</h3>
      <p>Clone the repository and install dependencies:</p>
      <pre>
git clone https://github.com/Lola-jo/space_mining.git
cd space_mining
pip install gymnasium numpy pygame stable-baselines3
      </pre>
      
      <h3>Test Environment</h3>
      <pre>
python test_env.py
      </pre>
      
      <h3>Train Agent</h3>
      <pre>
python train.py
      </pre>
      
    </section>
    <section>
      <h2>More Information</h2>
      <ul>
        <li><a href="README.md">Full Documentation (README)</a></li>
        <li><a href="https://github.com/Lola-jo/space_mining" target="_blank">GitHub Repository</a></li>
        <li><a href="https://github.com/Lola-jo/space_mining/issues" target="_blank">Report Issues</a></li>
      </ul>
    </section>
  </div>
  

</body>
</html>